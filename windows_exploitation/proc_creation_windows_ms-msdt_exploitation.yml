title: ms-msdt for RCE CVE-2022-30190
id: 5eff5816-a518-4ab8-b7e0-a776344e7d36
description: Detecting the execution of weaponized maldoc or embedded link in outlook that uses ms-msdt scheme to execute code.
status: experimental
references:
  - https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/
  - https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-30190
  - https://twitter.com/nao_sec/status/1530196847679401984
  - https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e
  - https://twitter.com/secforce_ltd/status/1531987722293886978?s=21&t=f6-tesTzFEhR7TSoyTtp8Q
author: '@Kostastsale'
date: 2022/05/29
logsource:
    category: process_creation
    product: windows
detection:
    selection1:
        Image|endswith:
          - '\msdt.exe'
        CommandLine|contains|all:
          - 'msdt'
          - '/id'
    selection2:
        CommandLine|contains|all:
          - 'IT_BrowseForFile'
          - 'IT_LaunchMethod'
    selection3:
        CommandLine|contains|all:
          - '/af'
          - '.xml'
    condition: selection1 and (selection2 or selection3)
falsepositives:
    - Uknown
level: high
tags:
    - attack.execution
    - attack.T1059.003
    - attack.T1204.002